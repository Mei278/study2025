<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>è´¨é‡æ£€éªŒç³»ç»Ÿ</title>
    <style>
        body {
            font-family: "Microsoft YaHei", sans-serif;
            margin: 40px;
            background-color: #f9f9f9;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px;
        }
        .header {
            text-align: center;
            margin-bottom: 50px;
            padding: 30px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        .subtitle {
            color: #666;
            font-size: 1.2em;
            margin-bottom: 30px;
        }
        .nav-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        .nav-card {
            background: white;
            padding: 40px 30px;
            border-radius: 10px;
            text-align: center;
            text-decoration: none;
            color: #333;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        .nav-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border-color: #007bff;
            text-decoration: none;
            color: #333;
        }
        .nav-icon {
            font-size: 3em;
            margin-bottom: 20px;
            display: block;
        }
        .nav-title {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .nav-description {
            color: #666;
            line-height: 1.6;
        }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 40px 0;
        }
        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
            margin-bottom: 5px;
        }
        .stat-label {
            color: #666;
            font-size: 0.9em;
        }
        .system-info {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-top: 40px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .system-info h3 {
            color: #333;
            margin-bottom: 15px;
        }
        .system-info p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>è´¨é‡æ£€éªŒç³»ç»Ÿ</h1>
        <div class="subtitle">å…¨é¢è´¨é‡ç®¡ç† Â· æ•°å­—åŒ–æ£€éªŒæµç¨‹ Â· å®æ—¶æ•°æ®ç›‘æ§</div>

        <!-- ç»Ÿè®¡ä¿¡æ¯åŒºåŸŸ -->
        <div class="stats">
            <div class="stat-card">
                <div class="stat-number" id="pending-count">--</div>
                <div class="stat-label">å¾…æ£€éªŒè®¢å•</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="inspected-count">--</div>
                <div class="stat-label">å·²æ£€éªŒè®¢å•</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="rejected-count">--</div>
                <div class="stat-label">ä¸åˆæ ¼äº§å“</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="total-count">--</div>
                <div class="stat-label">æ€»è®¢å•æ•°</div>
            </div>
        </div>
    </div>

    <div class="nav-cards">
        <a href="/arrivals/" class="nav-card">
            <span class="nav-icon">ğŸ“¦</span>
            <div class="nav-title">é‡‡è´­åˆ°è´§ä¿¡æ¯</div>
            <div class="nav-description">
                æŸ¥çœ‹æ‰€æœ‰é‡‡è´­è®¢å•çš„åˆ°è´§çŠ¶æ€ï¼Œå¤„ç†å¾…æ£€éªŒçš„é‡‡è´­é¡¹ç›®ï¼Œè·Ÿè¸ªæ£€éªŒè¿›åº¦ã€‚
            </div>
        </a>

        <a href="/inspections/" class="nav-card">
            <span class="nav-icon">ğŸ”</span>
            <div class="nav-title">è´¨é‡æ£€éªŒè®°å½•</div>
            <div class="nav-description">
                æµè§ˆå†å²æ£€éªŒè®°å½•ï¼ŒæŸ¥çœ‹æ£€éªŒç»“æœè¯¦æƒ…ï¼Œåˆ†æäº§å“è´¨é‡è¶‹åŠ¿ã€‚
            </div>
        </a>

        <a href="/rejections/" class="nav-card">
            <span class="nav-icon">âš ï¸</span>
            <div class="nav-title">ä¸åˆæ ¼äº§å“å¤„ç†</div>
            <div class="nav-description">
                ç®¡ç†ä¸åˆæ ¼äº§å“è®°å½•ï¼Œè·Ÿè¸ªå¤„ç†è¿›åº¦ï¼Œè®°å½•æœ€ç»ˆå¤„ç½®æ–¹å¼ã€‚
            </div>
        </a>
    </div>

    <div class="system-info">
        <h3>ç³»ç»Ÿæ¦‚è¿°</h3>
        <p>è´¨é‡æ£€éªŒç³»ç»ŸåŸºäºå¾®æœåŠ¡æ¶æ„æ„å»ºï¼ŒåŒ…å«é‡‡è´­åˆ°è´§ã€è´¨é‡æ£€éªŒã€ä¸åˆæ ¼äº§å“å¤„ç†ä¸‰å¤§æ ¸å¿ƒæ¨¡å—ã€‚</p>
        <p>ç³»ç»Ÿå®ç°äº†ä»é‡‡è´­åˆ°è´§åˆ°è´¨é‡æ£€éªŒï¼Œå†åˆ°ä¸åˆæ ¼äº§å“å¤„ç†çš„å®Œæ•´è´¨é‡ç®¡ç†æµç¨‹ã€‚</p>
        <p>ğŸ”¹ <strong>é‡‡è´­åˆ°è´§æœåŠ¡</strong>ï¼šç®¡ç†é‡‡è´­è®¢å•å’Œåˆ°è´§ä¿¡æ¯ï¼ŒçŠ¶æ€åŒ…æ‹¬"å¾…æ£€éªŒ"ã€"æ£€éªŒä¸­"ã€"æ£€éªŒåˆæ ¼"ã€"æ£€éªŒä¸åˆæ ¼"</p>
        <p>ğŸ”¹ <strong>è´¨é‡æ£€éªŒæœåŠ¡</strong>ï¼šæ‰§è¡Œäº§å“è´¨é‡æ£€éªŒï¼Œè®°å½•æ£€éªŒç»“æœå’Œä¸åˆæ ¼é¡¹</p>
        <p>ğŸ”¹ <strong>ä¸åˆæ ¼äº§å“æœåŠ¡</strong>ï¼šå¤„ç†æ£€éªŒä¸åˆæ ¼çš„äº§å“ï¼Œè·Ÿè¸ªå¤„ç½®çŠ¶æ€</p>
    </div>

    <script>
        // è·å–ç»Ÿè®¡æ•°æ®çš„å‡½æ•°
        async function fetchStats() {
            try {
                // è·å–é‡‡è´­è®¢å•æ•°æ®
                const procurementResponse = await fetch('http://localhost:5001/api/purchase_orders');
                if (procurementResponse.ok) {
                    const orders = await procurementResponse.json();

                    // è®¡ç®—ç»Ÿè®¡æ•°æ®
                    const pendingCount = orders.filter(order => order.status === 'å¾…æ£€éªŒ').length;
                    const inspectedCount = orders.filter(order =>
                        order.status === 'æ£€éªŒåˆæ ¼' || order.status === 'æ£€éªŒä¸åˆæ ¼').length;
                    const totalCount = orders.length;

                    // æ›´æ–°é‡‡è´­ç›¸å…³ç»Ÿè®¡
                    document.getElementById('pending-count').textContent = pendingCount;
                    document.getElementById('inspected-count').textContent = inspectedCount;
                    document.getElementById('total-count').textContent = totalCount;
                }

                // è·å–ä¸åˆæ ¼äº§å“æ•°æ®
                const rejectionResponse = await fetch('http://localhost:5003/api/rejections');
                if (rejectionResponse.ok) {
                    const rejections = await rejectionResponse.json();
                    document.getElementById('rejected-count').textContent = rejections.length;
                }
            } catch (error) {
                console.error('è·å–ç»Ÿè®¡æ•°æ®å¤±è´¥:', error);
                // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œæ˜¾ç¤ºé»˜è®¤å€¼
                document.getElementById('pending-count').textContent = '0';
                document.getElementById('inspected-count').textContent = '0';
                document.getElementById('rejected-count').textContent = '0';
                document.getElementById('total-count').textContent = '0';
            }
        }

        // é¡µé¢åŠ è½½æ—¶è·å–ç»Ÿè®¡æ•°æ®
        document.addEventListener('DOMContentLoaded', fetchStats);
    </script>
</body>
</html>